---
## Front matter
lang: ru-RU
title: "Задача об эпидемии"
author: "Морозов Михаил Евгеньевич"
author:
	- Морозов М. E.
institute: Российский Университет Дружбы Народов, Moscow, Russian Federation

date: 9 марта 2024

## i18n babel
babel-lang: russian
babel-otherlangs: english

## Formatting pdf
toc: false
toc-title: Содержание
slide_level: 2
aspectratio: 169
section-titles: true
theme: metropolis
header-includes:
 - \metroset{progressbar=frametitle,sectionpage=progressbar,numbering=fraction}
 - '\makeatletter'
 - '\beamer@ignorenonframefalse'
 - '\makeatother'
---


# Вводная часть

Компартментные модели — это очень общий метод моделирования. Их часто применяют для математического моделирования инфекционных заболеваний. 
Население распределяется по отсекам с метками, например, S , I или R (Восприимчивый, Инфекционный или Выздоровевший). 
Люди могут перемещаться между отсеками. Порядок меток обычно показывает структуру потока между отсеками; например, 
SEIS означает «восприимчивый», «разоблаченный», «заразный», а затем снова «восприимчивый».
Эта модель является достаточно прогностической для инфекционных заболеваний, которые передаются от человека к человеку 
и при которых выздоровление обеспечивает устойчивую устойчивость, таких как корь , эпидемический паротит и краснуха . 

## Теоретическое введение для задачи 
Рассмотрим простейшую модель эпидемии. Предположим, что некая популяция, состоящая из N особей, (считаем, что популяция изолирована)
подразделяется на три группы. Первая группа - это восприимчивые к болезни, но пока здоровые особи, обозначим их через S(t). Вторая группа – это число
инфицированных особей, которые также при этом являются распространителями инфекции, обозначим их I(t). А третья группа, обозначающаяся через R(t) – это
здоровые особи с иммунитетом к болезни.

До того, как число заболевших не превышает критического значения I*, считаем, что все больные изолированы и не заражают здоровых. 
Когда $I(t) > I*$, тогда инфицирование способны заражать восприимчивых к болезни особей.

## Теоретическое введение для задачи 
Таким образом, скорость изменения числа S(t) меняется по следующему закону:

$$
\frac{dS}{dt} = 
\begin{cases}
-\alpha S \textrm{, если  }I(t) > I* \\
0 \textrm{, если  } I(t) <= I*
\end{cases}
$$

I(t) меняется по следующему закону:

$$
\frac{dI}{dt} = 
\begin{cases}
\alpha S - \beta I \textrm{, если  }I(t) > I* \\
-\beta I \textrm{, если  } I(t) <= I*
\end{cases}
$$

R(t) меняется по следующему закону:
$\frac{dR}{dt} = \beta I$

Постоянные пропорциональности, $\alpha$, $\beta$ - это коэффициенты заболеваемости и выздоровления соответственно.

Будем считать, что начало эпидемии происходит в момент времени t = 0.

# Постановка задачи

На одном острове вспыхнула эпидемия. Известно, что из всех проживающих на острове $(N=11 456)$ в момент начала эпидемии $(t=0)$ число заболевших людей (являющихся распространителями инфекции) $I(0)=97$, А число здоровых людей с иммунитетом к болезни $R(0)=37$. Таким образом, число людей восприимчивых к болезни, но пока здоровых, в начальный момент времени $S(0)=N-I(0)- R(0)$.

# Задание 
Постройте графики изменения числа особей в каждой из трех групп. Рассмотрите, как будет протекать эпидемия в случае:
$$1)если I(0)<=I*$$ 
$$2)если I(0)>I*$$


Постройте график зависимости численности хищников от численности жертв, а также графики изменения численности хищников и численности жертв при
следующих начальных условиях: $x0=10$, $y0=30$.
Найдите стационарное состояние системы.

# Выполнение лабораторной работы

## Код на julia
Выполнение лабораторной работе на языке julia
```julia
using Plots
using DifferentialEquations
using OrdinaryDiffEq

#функция для I(0)<=I*
function nocr(du,u,p,t)
    a,b = p
    du[1] = 0
    du[2] = -b*u[2]
    du[3] = b*u[2]
end

#функция для I(0) > I*
function crit(du,u,p,t)
    a,b = p
    du[1] = -a*u[1]
    du[2] = a*u[1]-b*u[2]
    du[3] = b*u[2]
end
```
## Код на julia
```julia
#Начальные условия
N = 11456
p = [0.01,0.02]
x0 = [N-97-37,37,97]
tspan = (0,1000)

prob1 = ODEProblem(nocr,x0,tspan,p)
prob2 = ODEProblem(crit,x0,tspan,p)

sol1 = solve(prob1,Tsit5(),dtmax = 0.05)
sol2 = solve(prob2,Tsit5(),dtmax = 0.05)

plot(sol1,title = "I(t)<=I*")
plot(sol2,title = "I(t) > I*")
```
## Код на Open Modelica

##Код для первого случая

```OpenModelica
model lab6

parameter Real a = 0.01;
parameter Real b = 0.02;


Real S(start = 11456-97-37);
Real I(start = 97);
Real R(start = 37);

equation
  der(S)= 0;
  der(I)= -b*I;  
  der(R)= b*I;

end lab6;
```

## Код для второго случая
```OpenModelica
model lab6

parameter Real a = 0.01;
parameter Real b = 0.02;


Real S(start = 11456-97-37);
Real I(start = 97);
Real R(start = 37);

equation
  der(S)= -a*S;
  der(I)= a*S-b*I;  
  der(R)= b*I;

end lab6;
```

# Результаты работы кода 

## Julia сл.1
![Результат сл1 Julia](ljl1.png){ #fig:001 width=70% }

## Open Modelica сл.1
![Результат сл1 OM](om61.png){ #fig:002 width=70% }

## Julia сл.2
![Результат сл2 Julia](ljl2.png){ #fig:003 width=70% }

## Open Modelica сл.2
![Результат сл2 OM](om62.png){ #fig:004 width=70% }

# Выводы
В результате выполнения лабораторной работы я узнал как строить простейшую модель об эпидемии. Выполнил мат. модель для двух случаев в Julia и Open Modelica и получил результаты.

